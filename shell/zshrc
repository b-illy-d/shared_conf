# Hi Mom

# env

if [[ -n $SSH_CONNECTION ]]; then
  export EDITOR='vim'
else
  export EDITOR='nvim'
fi

[[ -f ~/.local/bin/env ]] && source ~/.local/bin/env
[[ -f ~/.zshenv ]] && source ~/.zshenv
[[ -f ~/shared_conf/shell/nvm.env ]] && source ~/shared_conf/shell/nvm.env
[[ -f ~/.fzf.zsh ]] && source ~/.fzf.zsh
[[ -f ~/shared_conf/shell/bash_aliases ]] && source ~/shared_conf/shell/bash_aliases
[[ -f ~/shared_conf/shell/git.sh ]] && source ~/shared_conf/shell/git.sh

# --- completions (zsh + bash-compatible) ---
# keep system dirs in $fpath so compinit exists
typeset -U fpath
fpath=( ~/.zfunc $fpath /opt/homebrew/share/zsh/site-functions /usr/local/share/zsh/site-functions /usr/share/zsh/site-functions )

# make sure dump dir exists
mkdir -p ~/.cache/zsh

autoload -Uz compinit
compinit -C -d ~/.cache/zsh/.zcompdump-$ZSH_VERSION

# enable bash-style completion for scripts that use `complete`
autoload -Uz +X bashcompinit 2>/dev/null || true
type bashcompinit >/dev/null 2>&1 && bashcompinit

# pyenv init
command -v pyenv >/dev/null && eval "$(pyenv init - zsh)"

# ----- gcloud (guarded; sourcing these can be slow, so only if installed)
GCSDK="/opt/homebrew/Caskroom/google-cloud-sdk/latest/google-cloud-sdk"
[[ -r "$GCSDK/path.zsh.inc" ]] && source "$GCSDK/path.zsh.inc"
[[ -r "$GCSDK/completion.zsh.inc" ]] && source "$GCSDK/completion.zsh.inc"

# Arrow keys: search history by current prefix
if [[ -n ${terminfo[kcuu1]} ]]; then
  bindkey "${terminfo[kcuu1]}" history-beginning-search-backward
  bindkey "${terminfo[kcud1]}" history-beginning-search-forward
fi
bindkey '^P' history-beginning-search-backward
bindkey '^N' history-beginning-search-forward

