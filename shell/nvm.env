# --- nvm: lazy + silent ---
export NVM_DIR="${NVM_DIR:-$HOME/.nvm}"
typeset -g __NVM_LOADED

[[ -n "$__NVM_LOADED" ]] && return 0
[[ -s "$NVM_DIR/nvm.sh" ]] && . "$NVM_DIR/nvm.sh" && __NVM_LOADED=1 

# auto-use .nvmrc on cd (quiet)
autoload -Uz add-zsh-hook
_nvm_auto_use() {
[[ -f "${PWD}/.nvmrc" ]] || return 0
  _load_nvm || return 0
  local want cur
  want="$(<.nvmrc 2>/dev/null)"
  cur="$(nvm current 2>/dev/null)"
  [[ "$want" = "$cur" ]] && return 0
  nvm use --silent >/dev/null 2>&1
}
add-zsh-hook chpwd _nvm_auto_use
_nvm_auto_use

