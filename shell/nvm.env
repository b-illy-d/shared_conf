# --- nvm: lazy + silent ---
export NVM_DIR="$HOME/.nvm"
_load_nvm() { [[ -s "$NVM_DIR/nvm.sh" ]] && . "$NVM_DIR/nvm.sh"; }

# lazy wrappers (first call loads nvm, then defers)
nvm()      { _load_nvm; command nvm "$@"; }
node()     { _load_nvm; command node "$@"; }
npm()      { _load_nvm; command npm "$@"; }
npx()      { _load_nvm; command npx "$@"; }
corepack() { _load_nvm; command corepack "$@"; }

# auto-use .nvmrc on cd (quiet)
autoload -Uz add-zsh-hook
_nvm_auto_use() {
  [[ -f "${PWD}/.nvmrc" ]] || return 0
  typeset -f nvm >/dev/null || _load_nvm
  nvm use --silent >/dev/null 2>&1
}
add-zsh-hook chpwd _nvm_auto_use
_nvm_auto_use  # run once for initial dir

